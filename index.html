<!DOCTYPE html>
<html lang="kk">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smart Schedule Offline Pro</title>
<style>
        :root {
            --bg-color: #0d1117;
            --accent-indigo: #5c6aff;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.5);
            --holiday-red: #ef4444;
            --vacation-orange: #f97316;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            height: 100dvh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px;
            overflow-x: hidden;
        }

        .container { width: 100%; max-width: 450px; display: flex; flex-direction: column; gap: 20px; }

        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
        }

        /* --- UPDATE UI --- */
        #update-banner {
            display: none; padding: 16px; background: var(--accent-indigo);
            border-radius: 20px; justify-content: space-between; align-items: center;
            margin-bottom: 15px; box-shadow: 0 10px 20px rgba(92, 106, 255, 0.2);
        }

        .upd-btn { background: white; color: black; border: none; padding: 8px 16px; border-radius: 12px; font-weight: bold; font-size: 12px; cursor: pointer; }

        #install-overlay {
            display: none; position: fixed; inset: 0; background: var(--bg-color);
            z-index: 1000; flex-direction: column; align-items: center; justify-content: center; text-align: center;
        }

        .loader { width: 60px; height: 60px; border: 6px solid var(--glass-border); border-top: 6px solid var(--accent-indigo); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* --- ТАБТАР АДАПТАЦИЯСЫ (Прокруткасыз) --- */
        .tabs { 
            display: flex; 
            padding: 6px; 
            gap: 4px; /* Батырмалар арасы сыюы үшін азайтылды */
            background: rgba(255, 255, 255, 0.02);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            width: 100%; /* Экран еніне толық жайылады */
            overflow: hidden; /* Прокрутканы өшіру */
        }
        
        .tab-btn {
            flex: 1; /* Барлық батырма тең орын алады */
            padding: 10px 2px; 
            border: none; 
            background: transparent;
            color: var(--text-muted); 
            font-size: 9px; /* Шағын экрандар үшін қаріп кішірейтілді */
            font-weight: 800; 
            border-radius: 14px;
            cursor: pointer; 
            transition: all 0.3s ease;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 5px;
        }

        .tab-btn svg { 
            width: 18px; 
            height: 18px; 
            stroke: currentColor; 
            fill: none; 
            stroke-width: 2.5; 
            opacity: 0.5;
            transition: 0.3s;
        }

        .tab-btn.active { 
            background: var(--accent-indigo); 
            color: white; 
            box-shadow: 0 4px 12px rgba(92, 106, 255, 0.4);
        }

        .tab-btn.active svg { opacity: 1; transform: scale(1.1); }

        /* --- MAIN UI --- */
        .hero-card { padding: 24px; text-align: center; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4); }
        .day-label { font-size: 10px; font-weight: 800; letter-spacing: 2px; color: var(--text-muted); text-transform: uppercase; }
        .status-badge { font-size: 12px; font-weight: 900; color: var(--accent-indigo); margin-top: 8px; letter-spacing: 1px; }
        .lesson-name { font-size: 22px; font-weight: 800; margin: 8px 0; }
        .timer-display { font-size: 46px; font-weight: 900; color: #fff; margin: 10px 0; }

        .content-area { display: flex; flex-direction: column; gap: 10px; }
        .list-item { padding: 16px; display: flex; justify-content: space-between; align-items: center; }
        .item-num { font-size: 9px; font-weight: 900; color: var(--accent-indigo); text-transform: uppercase; }
        .item-title { font-size: 14px; font-weight: 600; }
        .time-badge { font-size: 11px; font-weight: 700; color: var(--text-muted); background: rgba(255,255,255,0.05); padding: 6px 10px; border-radius: 10px; }
        .weekly-day-title { font-size: 11px; font-weight: 900; color: var(--accent-indigo); margin: 15px 0 10px 10px; text-transform: uppercase; }

        /* --- CALENDAR --- */
        .cal-container { padding: 20px; }
        .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .cal-month { font-weight: 800; text-transform: uppercase; letter-spacing: 1px; font-size: 13px; }
        .cal-nav { background: var(--glass-bg); border: none; color: white; padding: 8px 12px; border-radius: 10px; font-weight: bold; }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; text-align: center; }
        .cal-weekday { font-size: 9px; font-weight: 800; color: var(--accent-indigo); padding-bottom: 8px; }
        .cal-day { aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; border-radius: 10px; border: 1px solid transparent; }
        .cal-today { background: var(--accent-indigo); color: white; }
        .cal-holiday { color: var(--holiday-red); font-weight: 800; }
        .cal-vacation { border-color: var(--vacation-orange); color: var(--vacation-orange); }
        .cal-other { opacity: 0.1; }

        .hidden { display: none; }
</style>
  </head>
  <body>

    <div id="update-banner" class="container">
        <span style="font-weight: bold; font-size: 13px;">Жаңа нұсқа дайын!</span>
        <button class="upd-btn" onclick="startUpdate()">ЖАҢАРТУ</button>
    </div>

    <div id="install-overlay">
        <div id="loader-circle" class="loader"></div>
        <h2 id="install-title" style="margin-top: 20px; font-weight: 900;">ЖҮКТЕЛУДЕ...</h2>
        <p id="install-desc" style="opacity: 0.5; margin-top: 10px;">Файлдарды жаңартып жатырмыз</p>
        <div id="countdown-timer" class="timer-val hidden">10</div>
    </div>

	<div class="container">
	  <div class="glass hero-card">
        <div id="hero-day" class="day-label">КҮТІҢІЗ...</div>
        <div id="hero-status" class="status-badge">АНЫҚТАЛУДА</div>
        <div id="hero-lesson" class="lesson-name">---</div>
        <div id="hero-timer" class="timer-display">00:00:00</div>
	  </div>

      <div class="tabs">
        <button id="btn-today" class="tab-btn active" onclick="showView('today')">
            <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
            БҮГІН
        </button>
        <button id="btn-bells" class="tab-btn" onclick="showView('bells')">
            <svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
            ҚОҢЫРАУ
        </button>
        <button id="btn-all" class="tab-btn" onclick="showView('all')">
            <svg viewBox="0 0 24 24"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
            АПТА
        </button>
        <button id="btn-cal" class="tab-btn" onclick="showView('cal')">
            <svg viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            КҮНДЕР
        </button>
	  </div>

	  <div id="view-today" class="content-area"></div>
	  <div id="view-bells" class="content-area hidden"></div>
	  <div id="view-all" class="content-area hidden"></div>
      
      <div id="view-cal" class="content-area hidden">
          <div class="glass cal-container">
              <div class="cal-header">
                  <button class="cal-nav" onclick="changeMonth(-1)">←</button>
                  <div class="cal-month" id="calMonthYear">АҚПАН 2026</div>
                  <button class="cal-nav" onclick="changeMonth(1)">→</button>
              </div>
              <div class="cal-grid" id="calGrid"></div>
              <div class="cal-info">
              </div>
          </div>
      </div>
	</div>

<script>
    // --- CALENDAR DATA ---
    const schoolData = {
        holidays: ["10-25", "12-16", "01-01", "01-02", "03-08", "03-21", "03-22", "03-23", "05-01", "05-07", "05-09"],
        vacations: [
            {start: "2025-10-27", end: "2025-11-02"},
            {start: "2025-12-29", end: "2026-01-07"},
            {start: "2026-03-19", end: "2026-03-29"}, // Spring Fixed
            {start: "2026-05-25", end: "2026-08-31"}  // Summer Fixed
        ]
    };

    let calDate = new Date();

    function getLocalDateStr(year, month, day) {
        return year + "-" + (month + 1).toString().padStart(2, '0') + "-" + day.toString().padStart(2, '0');
    }

    function renderCalendar() {
        const grid = document.getElementById('calGrid');
        const label = document.getElementById('calMonthYear');
        grid.innerHTML = "";

        const y = calDate.getFullYear(), m = calDate.getMonth();
        const monthNames = ["Қаңтар", "Ақпан", "Наурыз", "Сәуір", "Мамыр", "Маусым", "Шілде", "Тамыз", "Қыркүйек", "Қазан", "Қараша", "Желтоқсан"];
        label.innerText = `${monthNames[m].toUpperCase()} ${y}`;

        ["Дүй", "Сей", "Сәр", "Бей", "Жұм", "Сен", "Жек"].forEach(wd => grid.innerHTML += `<div class="cal-weekday">${wd}</div>`);

        const firstDay = new Date(y, m, 1).getDay();
        const daysInMonth = new Date(y, m + 1, 0).getDate();
        const startPad = (firstDay === 0) ? 6 : firstDay - 1;

        for(let i=0; i<startPad; i++) grid.innerHTML += `<div class="cal-day cal-other"></div>`;

        const today = new Date();
        const todayStr = getLocalDateStr(today.getFullYear(), today.getMonth(), today.getDate());

        for(let d=1; d<=daysInMonth; d++) {
            const currentStr = getLocalDateStr(y, m, d);
            const shortDate = currentStr.slice(5);
            
            let classes = "cal-day glass";
            if(currentStr === todayStr) classes += " cal-today";
            if(schoolData.holidays.includes(shortDate)) classes += " cal-holiday";
            
            schoolData.vacations.forEach(v => {
                if(currentStr >= v.start && currentStr <= v.end) classes += " cal-vacation";
            });

            grid.innerHTML += `<div class="${classes}">${d}</div>`;
        }
        updateCountdown();
    }

    function updateCountdown() {
        const now = new Date();
        const todayStr = getLocalDateStr(now.getFullYear(), now.getMonth(), now.getDate());
        let nextVac = null;

        for (const v of schoolData.vacations) {
            if (v.start > todayStr) {
                nextVac = new Date(v.start);
                break;
            }
        }

        const label = document.getElementById('daysToVacation');
        if (nextVac) {
            const diff = Math.ceil((nextVac - now) / (1000 * 60 * 60 * 24));
        } else {
            label.innerText = "ОҚУ ЖЫЛЫ АЯҚТАЛДЫ!";
        }
    }

    function changeMonth(val) { calDate.setMonth(calDate.getMonth() + val); renderCalendar(); }

    // --- BASE APP LOGIC ---
    function showUpdateBanner() { document.getElementById('update-banner').style.display = 'flex'; }
    function startUpdate() { document.getElementById('update-banner').style.display = 'none'; document.getElementById('install-overlay').style.display = 'flex'; Android.startUpdate(); }
    function startFinishCountdown() {
        document.getElementById('loader-circle').style.display = 'none';
        document.getElementById('install-title').innerText = "ЖАҢАРТУ ОРНАТЫЛДЫ";
        const t = document.getElementById('countdown-timer'); t.classList.remove('hidden');
        let s = 10;
        const i = setInterval(() => { s--; t.innerText = s; if (s <= 0) { clearInterval(i); Android.reloadApp(); } }, 1000);
    }

    const schedule = [[], ["Қазақ тілі", "Алгебра", "Физика", "Орыс тілі", "Информатика", "Қазақстан тарихы", "Дене шынықтыру"], ["Ағылшын тілі", "Геометрия", "Дүниежүзі тарихы", "Қазақ әдебиеті", "Химия", "Жаһандық құзірет", "АӘД"], ["Физика", "Биология", "Қазақ тілі", "Қазақстан тарихы", "Құқық", "Ағылшын тілі", "Сынып сағаты"], ["Алгебра", "Қазақ әдебиеті", "Дүниежүзі тарихы", "Биология", "Орыс тілі", "Таңдау пәні", "Дене шынықтыру"], ["Ағылшын тілі", "Химия", "Алгебра", "Қазақ әдебиеті", "Дене шынықтыру", "География", "Таңдау пәні"], []];
    const dayNames = ["ЖЕКСЕНБІ", "ДҮЙСЕНБІ", "СЕЙСЕНБІ", "СӘРСЕНБІ", "БЕЙСЕНБІ", "ЖҰМА", "СЕНБІ"];
    const starts = [480, 525, 580, 635, 680, 725, 770], ends = [520, 565, 620, 675, 720, 765, 810];

    function formatTimeLabel(min) { return Math.floor(min/60) + ":" + (min%60).toString().padStart(2, '0'); }

    function updateApp() {
        const now = new Date();
        const d = now.getDay(), h = now.getHours(), m = now.getMinutes(), s = now.getSeconds();
        const curSec = (h * 3600) + (m * 60) + s;
        let day = (h >= 18) ? (d + 1) % 7 : d;
        document.getElementById('hero-day').innerText = (h >= 18 ? "ЕРТЕҢ: " : "") + dayNames[day];
        
        let status = "ДЕМ АЛЫС", lesson = "САБАҚ ЖОҚ", timer = "00:00:00";
        if (day >= 1 && day <= 5) {
            const list = schedule[day];
            const s0 = starts[0] * 60, e6 = ends[6] * 60;
            if (curSec < s0 && h < 18) { status = "КҮТІҢІЗ"; lesson = "1-ші: " + list[0]; timer = formatDiff(s0 - curSec); }
            else if (curSec > e6 && h < 18) { status = "АЯҚТАЛДЫ"; lesson = "ҮЙГЕ ҚАЙТУ"; timer = "✓"; }
            else if (h >= 18) { status = "ДАЙЫНДЫҚ"; lesson = "ЕРТЕҢ: " + list[0]; }
            else {
                for (let i = 0; i < 7; i++) {
                    let s_i = starts[i] * 60, e_i = ends[i] * 60;
                    if (curSec >= s_i && curSec <= e_i) { status = (i+1)+"-ші САБАҚ"; lesson = list[i]; timer = formatDiff(e_i - curSec); break; }
                    if (i < 6 && curSec > e_i && curSec < starts[i+1]*60) { status = "ҮЗІЛІС"; lesson = "Келесі: "+list[i+1]; timer = formatDiff(starts[i+1]*60 - curSec); break; }
                }
            }
        }
        document.getElementById('hero-status').innerText = status;
        document.getElementById('hero-lesson').innerText = lesson;
        document.getElementById('hero-timer').innerText = timer;
        renderToday(day);
    }

    function formatDiff(s) { const mm = Math.floor(s/60), ss = s%60; return mm.toString().padStart(2, '0') + ":" + ss.toString().padStart(2, '0'); }

    function renderToday(dayIdx) {
        const container = document.getElementById('view-today');
        const list = schedule[dayIdx];
        if (!list || list.length === 0) { container.innerHTML = `<div class="glass list-item" style="justify-content:center; opacity:0.5">Сабақ жоқ</div>`; return; }
        container.innerHTML = list.map((n, i) => `<div class="glass list-item"><div style="display:flex; flex-direction:column;"><span class="item-num">${i+1}-САБАҚ</span><span class="item-title">${n}</span></div><span class="time-badge">${formatTimeLabel(starts[i])}</span></div>`).join('');
    }

    function showView(view) {
        ['today', 'bells', 'all', 'cal'].forEach(v => {
            document.getElementById('view-' + v).classList.toggle('hidden', v !== view);
            document.getElementById('btn-' + (v === 'cal' ? 'cal' : v)).classList.toggle('active', v === view);
        });
        if(view === 'cal') renderCalendar();
    }

    function renderStatic() {
        document.getElementById('view-bells').innerHTML = starts.map((s, i) => `<div class="glass list-item"><span class="item-title">${i+1}-сабақ</span><span class="time-badge" style="color:var(--accent-indigo)">${formatTimeLabel(s)} — ${formatTimeLabel(ends[i])}</span></div>`).join('');
        let h = "";
        for(let d=1; d<=5; d++) {
            h += `<div class="weekly-day-title">${dayNames[d]}</div>`;
            h += schedule[d].map((n, i) => `<div class="glass list-item" style="margin-bottom:8px"><span class="item-title">${i+1}. ${n}</span></div>`).join('');
        }
        document.getElementById('view-all').innerHTML = h;
    }

    renderStatic();
    setInterval(updateApp, 1000);
    updateApp();
</script>
  </body>
</html>
